<div class="panel">
  <div class="panel__tabs">
    <button type="button" [class.active]="activeTab === 'content'" (click)="setTab('content')">Content</button>
    <button type="button" [class.active]="activeTab === 'typography'" (click)="setTab('typography')">
      Typography
    </button>
    <button type="button" [class.active]="activeTab === 'spacing'" (click)="setTab('spacing')">Spacing</button>
    <button type="button" [class.active]="activeTab === 'layout'" (click)="setTab('layout')">Layout</button>
    <button type="button" [class.active]="activeTab === 'position'" (click)="setTab('position')">Position</button>
    <button type="button" [class.active]="activeTab === 'states'" (click)="setTab('states')">States</button>
  </div>

  <div class="panel__body" *ngIf="node; else empty">
    <div class="panel__section" *ngIf="activeTab === 'content'">
      <ng-container [ngSwitch]="node?.type">
        <div *ngSwitchCase="'heading'" class="field">
          <label>Heading text</label>
          <textarea
            [ngModel]="node.content?.text"
            (ngModelChange)="updateContent('text', $event)"
          ></textarea>
          <label>Tag</label>
          <select [ngModel]="node.content?.tag" (ngModelChange)="updateContent('tag', $event)">
            <option value="h1">h1</option>
            <option value="h2">h2</option>
            <option value="h3">h3</option>
            <option value="h4">h4</option>
            <option value="h5">h5</option>
            <option value="h6">h6</option>
          </select>
        </div>

        <div *ngSwitchCase="'text'" class="field">
          <label>Text</label>
          <textarea [ngModel]="node.content?.text" (ngModelChange)="updateContent('text', $event)"></textarea>
        </div>

        <div *ngSwitchCase="'image'" class="field">
          <label>Image URL</label>
          <input [ngModel]="node.content?.src" (ngModelChange)="updateContent('src', $event)" />
          <label>Alt text</label>
          <input [ngModel]="node.content?.alt" (ngModelChange)="updateContent('alt', $event)" />
          <p class="hint">Uploads are disabled in Part-1. Use a URL.</p>
        </div>

        <div *ngSwitchCase="'button'" class="field">
          <label>Label</label>
          <input [ngModel]="node.content?.text" (ngModelChange)="updateContent('text', $event)" />
          <label>Link</label>
          <input [ngModel]="node.content?.href" (ngModelChange)="updateContent('href', $event)" />
          <label>Target</label>
          <select [ngModel]="node.content?.target" (ngModelChange)="updateContent('target', $event)">
            <option value="_self">Same tab</option>
            <option value="_blank">New tab</option>
          </select>
        </div>

        <div *ngSwitchCase="'list'" class="field">
          <label>List items</label>
          <textarea [ngModel]="node.content?.text" (ngModelChange)="updateContent('text', $event)"></textarea>
          <p class="hint">Use new lines for each list item.</p>
        </div>

        <div *ngSwitchDefault class="field">
          <p class="hint">This block does not have editable content.</p>
        </div>
      </ng-container>
    </div>

    <div class="panel__section" *ngIf="activeTab === 'typography'">
      <div class="field">
        <label>Font family</label>
        <select
          [ngModel]="node?.styles.default.fontFamily"
          (ngModelChange)="updateStyle('fontFamily', $event)"
        >
          <option value="Inter, Segoe UI, sans-serif">Primary</option>
          <option value="Georgia, serif">Secondary</option>
        </select>
      </div>
      <div class="grid">
        <div class="field">
          <label>Font size</label>
          <input
            [ngModel]="node?.styles.default.fontSize"
            (ngModelChange)="updateStyle('fontSize', $event)"
            placeholder="16px"
          />
        </div>
        <div class="field">
          <label>Weight</label>
          <input
            [ngModel]="node?.styles.default.fontWeight"
            (ngModelChange)="updateStyle('fontWeight', $event)"
            placeholder="400"
          />
        </div>
        <div class="field">
          <label>Line height</label>
          <input
            [ngModel]="node?.styles.default.lineHeight"
            (ngModelChange)="updateStyle('lineHeight', $event)"
            placeholder="1.6"
          />
        </div>
        <div class="field">
          <label>Align</label>
          <select
            [ngModel]="node?.styles.default.textAlign"
            (ngModelChange)="updateStyle('textAlign', $event)"
          >
            <option value="left">Left</option>
            <option value="center">Center</option>
            <option value="right">Right</option>
            <option value="justify">Justify</option>
          </select>
        </div>
      </div>
      <div class="field">
        <label>Color</label>
        <input
          [ngModel]="node?.styles.default.color"
          (ngModelChange)="updateStyle('color', $event)"
          placeholder="#111111"
        />
      </div>
    </div>

    <div class="panel__section" *ngIf="activeTab === 'spacing'">
      <div class="section-title">
        <h4>Margin</h4>
        <button type="button" class="link-toggle" (click)="linkMargin = !linkMargin">
          {{ linkMargin ? 'Linked' : 'Unlinked' }}
        </button>
      </div>
      <div class="grid spacing-grid">
        <div class="field">
          <label>Top</label>
          <input
            [ngModel]="getStyleValue('marginTop')"
            (ngModelChange)="updateSpacing('margin', 'Top', $event)"
          />
        </div>
        <div class="field">
          <label>Right</label>
          <input
            [ngModel]="getStyleValue('marginRight')"
            (ngModelChange)="updateSpacing('margin', 'Right', $event)"
          />
        </div>
        <div class="field">
          <label>Bottom</label>
          <input
            [ngModel]="getStyleValue('marginBottom')"
            (ngModelChange)="updateSpacing('margin', 'Bottom', $event)"
          />
        </div>
        <div class="field">
          <label>Left</label>
          <input
            [ngModel]="getStyleValue('marginLeft')"
            (ngModelChange)="updateSpacing('margin', 'Left', $event)"
          />
        </div>
      </div>

      <div class="section-title">
        <h4>Padding</h4>
        <button type="button" class="link-toggle" (click)="linkPadding = !linkPadding">
          {{ linkPadding ? 'Linked' : 'Unlinked' }}
        </button>
      </div>
      <div class="grid spacing-grid">
        <div class="field">
          <label>Top</label>
          <input
            [ngModel]="getStyleValue('paddingTop')"
            (ngModelChange)="updateSpacing('padding', 'Top', $event)"
          />
        </div>
        <div class="field">
          <label>Right</label>
          <input
            [ngModel]="getStyleValue('paddingRight')"
            (ngModelChange)="updateSpacing('padding', 'Right', $event)"
          />
        </div>
        <div class="field">
          <label>Bottom</label>
          <input
            [ngModel]="getStyleValue('paddingBottom')"
            (ngModelChange)="updateSpacing('padding', 'Bottom', $event)"
          />
        </div>
        <div class="field">
          <label>Left</label>
          <input
            [ngModel]="getStyleValue('paddingLeft')"
            (ngModelChange)="updateSpacing('padding', 'Left', $event)"
          />
        </div>
      </div>
    </div>

    <div class="panel__section" *ngIf="activeTab === 'layout'">
      <div class="grid">
        <div class="field">
          <label>Display</label>
          <select
            [ngModel]="node?.styles.default.display"
            (ngModelChange)="updateStyle('display', $event)"
          >
            <option value="block">Block</option>
            <option value="flex">Flex</option>
            <option value="grid">Grid</option>
          </select>
        </div>
        <div class="field">
          <label>Width</label>
          <input
            [ngModel]="node?.styles.default.width"
            (ngModelChange)="updateStyle('width', $event)"
            placeholder="auto"
          />
        </div>
        <div class="field">
          <label>Height</label>
          <input
            [ngModel]="node?.styles.default.height"
            (ngModelChange)="updateStyle('height', $event)"
            placeholder="auto"
          />
        </div>
        <div class="field">
          <label>Max width</label>
          <input
            [ngModel]="node?.styles.default.maxWidth"
            (ngModelChange)="updateStyle('maxWidth', $event)"
            placeholder="1200px"
          />
        </div>
      </div>
      <div class="field">
        <label>Background color</label>
        <input
          [ngModel]="node?.styles.default.backgroundColor"
          (ngModelChange)="updateStyle('backgroundColor', $event)"
          placeholder="#ffffff"
        />
      </div>
      <div class="grid">
        <div class="field">
          <label>Border</label>
          <input
            [ngModel]="node?.styles.default.border"
            (ngModelChange)="updateStyle('border', $event)"
            placeholder="1px solid #e5e7eb"
          />
        </div>
        <div class="field">
          <label>Radius</label>
          <input
            [ngModel]="node?.styles.default.borderRadius"
            (ngModelChange)="updateStyle('borderRadius', $event)"
            placeholder="12px"
          />
        </div>
        <div class="field">
          <label>Shadow</label>
          <input
            [ngModel]="node?.styles.default.boxShadow"
            (ngModelChange)="updateStyle('boxShadow', $event)"
            placeholder="0 8px 30px rgba(0,0,0,0.1)"
          />
        </div>
      </div>

      <div class="grid" *ngIf="node?.styles.default.display === 'flex'">
        <div class="field">
          <label>Align items</label>
          <select
            [ngModel]="node?.styles.default.alignItems"
            (ngModelChange)="updateStyle('alignItems', $event)"
          >
            <option value="stretch">Stretch</option>
            <option value="flex-start">Start</option>
            <option value="center">Center</option>
            <option value="flex-end">End</option>
          </select>
        </div>
        <div class="field">
          <label>Justify content</label>
          <select
            [ngModel]="node?.styles.default.justifyContent"
            (ngModelChange)="updateStyle('justifyContent', $event)"
          >
            <option value="flex-start">Start</option>
            <option value="center">Center</option>
            <option value="flex-end">End</option>
            <option value="space-between">Space between</option>
            <option value="space-around">Space around</option>
            <option value="space-evenly">Space evenly</option>
          </select>
        </div>
        <div class="field">
          <label>Gap</label>
          <input
            [ngModel]="node?.styles.default.gap"
            (ngModelChange)="updateStyle('gap', $event)"
            placeholder="16px"
          />
        </div>
      </div>
    </div>

    <div class="panel__section" *ngIf="activeTab === 'position'">
      <div class="grid">
        <div class="field">
          <label>Position</label>
          <select
            [ngModel]="node?.styles.default.position"
            (ngModelChange)="updateStyle('position', $event)"
          >
            <option value="static">Static</option>
            <option value="relative">Relative</option>
            <option value="absolute">Absolute</option>
          </select>
        </div>
        <div class="field">
          <label>Z-index</label>
          <input
            [ngModel]="node?.styles.default.zIndex"
            (ngModelChange)="updateStyle('zIndex', $event)"
          />
        </div>
      </div>
      <div class="grid spacing-grid">
        <div class="field">
          <label>Top</label>
          <input [ngModel]="node?.styles.default.top" (ngModelChange)="updateStyle('top', $event)" />
        </div>
        <div class="field">
          <label>Right</label>
          <input [ngModel]="node?.styles.default.right" (ngModelChange)="updateStyle('right', $event)" />
        </div>
        <div class="field">
          <label>Bottom</label>
          <input [ngModel]="node?.styles.default.bottom" (ngModelChange)="updateStyle('bottom', $event)" />
        </div>
        <div class="field">
          <label>Left</label>
          <input [ngModel]="node?.styles.default.left" (ngModelChange)="updateStyle('left', $event)" />
        </div>
      </div>
    </div>

    <div class="panel__section" *ngIf="activeTab === 'states'">
      <div class="field">
        <label>Hover background</label>
        <input
          [ngModel]="node?.styles.hover?.backgroundColor"
          (ngModelChange)="updateStyle('backgroundColor', $event, 'hover')"
          placeholder="#111111"
        />
      </div>
      <div class="field">
        <label>Hover color</label>
        <input
          [ngModel]="node?.styles.hover?.color"
          (ngModelChange)="updateStyle('color', $event, 'hover')"
          placeholder="#ffffff"
        />
      </div>
      <div class="field">
        <label>Hover shadow</label>
        <input
          [ngModel]="node?.styles.hover?.boxShadow"
          (ngModelChange)="updateStyle('boxShadow', $event, 'hover')"
          placeholder="0 10px 25px rgba(0,0,0,0.2)"
        />
      </div>
      <div class="field">
        <label>Hover border</label>
        <input
          [ngModel]="node?.styles.hover?.border"
          (ngModelChange)="updateStyle('border', $event, 'hover')"
          placeholder="1px solid #4f46e5"
        />
      </div>
    </div>
  </div>

  <ng-template #empty>
    <div class="panel__empty">
      <p>Select a block to edit its properties.</p>
    </div>
  </ng-template>
</div>
