<div class="preview">
  <style *ngIf="hoverStyles">{{ hoverStyles }}</style>
  <header class="preview__topbar">
    <div class="preview__title">
      <a class="ghost" [routerLink]="builderUrl">Back to Builder</a>
      <span>Preview</span>
    </div>
    <div class="view-toggle">
      <button type="button" [class.active]="viewMode === 'desktop'" (click)="viewMode = 'desktop'">Desktop</button>
      <button type="button" [class.active]="viewMode === 'tablet'" (click)="viewMode = 'tablet'">Tablet</button>
      <button type="button" [class.active]="viewMode === 'mobile'" (click)="viewMode = 'mobile'">Mobile</button>
    </div>
  </header>
  <div class="preview__canvas">
    <div
      class="preview__frame"
      [class.preview__frame--tablet]="viewMode === 'tablet'"
      [class.preview__frame--mobile]="viewMode === 'mobile'"
      [class.preview__frame--desktop]="viewMode === 'desktop'"
      [ngStyle]="{
        background: page?.settings?.baseBg || '#ffffff',
        color: page?.settings?.baseTextColor || '#0f172a',
        fontFamily: page?.settings?.primaryFont || 'system-ui, sans-serif'
      }"
    >
      <div class="preview__loading" *ngIf="loading && !page">Loading preview...</div>
      <div class="preview__empty" *ngIf="!loading && page && !hasContent">
        No content yet. Add blocks in the builder.
      </div>
      <app-node-renderer
        *ngIf="!loading && page && hasContent"
        [node]="page.root"
        [preview]="true"
        [viewport]="viewMode"
      ></app-node-renderer>
    </div>
  </div>
</div>
